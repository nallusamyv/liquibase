SELECT REGEXP_SUBSTR('abc/def/bcd=20220101/mainm.parquet', 'bcd=(\\d{8})', 1, 1, 'e')
from pyspark.sql import SparkSession

# Create SparkSession
spark = SparkSession.builder \
    .appName("S3 Example") \
    .config("spark.hadoop.fs.s3a.impl", "org.apache.hadoop.fs.s3a.S3AFileSystem") \
    .config("spark.hadoop.fs.s3a.access.key", "<your-access-key>") \
    .config("spark.hadoop.fs.s3a.secret.key", "<your-secret-key>") \
    .getOrCreate()
